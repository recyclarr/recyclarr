# E2E Test Configuration
# This configuration is designed to test all major recyclarr sync features
# URLs and API keys are replaced at runtime with actual container values

sonarr:
  sonarr_main:
    base_url: !env_var SONARR_URL
    api_key: !env_var SONARR_API_KEY

    quality_profiles:
      # User-defined quality profile (backward compat)
      - name: HD-1080p
        reset_unmatched_scores:
          enabled: true
        upgrade:
          allowed: true
          until_quality: Bluray-1080p
          until_score: 10000
        min_format_score: 0
        min_upgrade_format_score: 100
        quality_sort: top
        qualities:
          - name: Bluray-1080p
          - name: WEB 1080p
            qualities:
              - WEBDL-1080p
              - WEBRip-1080p
          - name: HDTV-1080p

      # Guide-synced quality profile with config overrides
      - trash_id: e2e00000000000000000000000000002
        name: E2E-SonarrGuideOverride
        min_upgrade_format_score: 150

      # Guide-only profile (tests pure inheritance - no config overrides)
      - trash_id: e2e00000000000000000000000000003

    custom_formats:
      - trash_ids:
          # A few commonly available formats for E2E testing
          - 32b367365729d530ca1c124a0b180c64 # Bad Dual Groups
          - 82d40da2bc6923f41e14394075dd4b03 # No-RlsGroup
          - e1a997ddb54e3ecbfe06341ad323c458 # Obfuscated
          - cf000000000000000000000000000002 # E2E-SonarrCustom
          - cf000000000000000000000000000007 # E2E-SonarrOverride (tests local override)
        assign_scores_to:
          # Tests assign_scores_to with trash_id (instead of name)
          - trash_id: e2e00000000000000000000000000002

    # CF groups - tests implicit profile assignment (no assign_scores_to)
    custom_format_groups:
      add:
        - trash_id: e2e00000000000000000000000000010

    # Quality definition with explicit overrides (tests numeric values)
    quality_definition:
      type: series
      qualities:
        - name: HDTV-1080p
          min: 5
          max: 50
          preferred: 30

    # Media management settings
    media_management:
      propers_and_repacks: do_not_upgrade

radarr:
  radarr_main:
    base_url: !env_var RADARR_URL
    api_key: !env_var RADARR_API_KEY

    quality_profiles:
      # User-defined quality profile (backward compat)
      - name: HD-1080p
        reset_unmatched_scores:
          enabled: true
        upgrade:
          allowed: true
          until_quality: Bluray-1080p
          until_score: 10000
        min_format_score: 0
        min_upgrade_format_score: 200
        quality_sort: top
        qualities:
          - name: Bluray-1080p
            qualities:
              - Bluray-1080p
              - Remux-1080p
          - name: WEB 1080p
            qualities:
              - WEBDL-1080p
              - WEBRip-1080p
          - name: HDTV-1080p

      # Guide-synced quality profile with config overrides
      - trash_id: e2e00000000000000000000000000001
        name: E2E-RadarrGuideOverride
        min_upgrade_format_score: 250
        upgrade:
          allowed: false

      # Guide-synced quality profile (tests implicit CF group inclusion from guide data)
      - trash_id: d1d67249d3890e49bc12e275d989a7e9 # HD Bluray + WEB

    custom_formats:
      - trash_ids:
          # Movie Versions - commonly available formats for E2E testing
          - 0f12c086e289cf966fa5948eac571f44 # Hybrid
          - 570bc9ebecd92723d2d21500f4be314c # Remaster
          - eca37840c13c6ef2dd0262b141a5482f # 4K Remaster
          - e0c07d59beb37348e975a930d5e50319 # Criterion Collection
          - 9d27d9d2181838f76dee150882bdc58c # Masters of Cinema
          - db9b4c4b53d312a3ca5f1378f6440fc9 # Vinegar Syndrome
          - 957d0f44b592285f26449575e8b1167e # Special Edition
          - cf000000000000000000000000000001 # E2E-TestFormat
        assign_scores_to:
          - name: HD-1080p

    # CF groups - tests explicit profile assignment with select+exclude composition
    # Group has: CF1 (required), CF2 (default), CF3 (non-default)
    # Exclude CF2, select CF3 -> result: CF1 + CF3 synced, CF2 excluded
    custom_format_groups:
      add:
        - trash_id: e2e00000000000000000000000000011
          exclude:
            - cf000000000000000000000000000006 # E2E-GroupCF2 (default, excluded)
          select:
            - cf000000000000000000000000000008 # E2E-GroupCF3 (non-default, selected)
          assign_scores_to:
            - trash_id: e2e00000000000000000000000000001
            - name: HD-1080p

    # Quality definition with unlimited values and guide defaults
    quality_definition:
      type: movie
      qualities:
        - name: Bluray-1080p
          max: unlimited
          preferred: unlimited
        - name: HDTV-1080p
          min: 0
          max: 100
          preferred: 50

    media_naming:
      folder: default
      movie:
        rename: true
        standard: standard

    # Media management settings
    media_management:
      propers_and_repacks: do_not_prefer
